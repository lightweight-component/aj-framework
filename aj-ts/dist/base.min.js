"use strict";var aj,aj;Element.prototype.$=function(t,e){if("function"!=typeof e)return this.querySelector.apply(this,arguments);t=this.querySelectorAll(t);return t&&e&&Array.prototype.forEach.call(t,e),t},Element.prototype.up=function(t,e){if(t&&e)throw"只能任选一种参数，不能同时传";var r=this.parentNode;for(t=t&&t.toUpperCase();r;){if(t&&r.tagName==t)return r;if(e&&r.className&&~r.className.indexOf(e))return r;r=r.parentNode}return null},Function.prototype.delegate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=this,i=this.scope,s=arguments,u=arguments.length;return function(){for(var t=arguments.length,e=t<u?u:t,r=0;r<e;r++)arguments[r]&&(s[r]=arguments[r]);s.length=e;for(var r=0,n=s.length;r<n;r++){var a=s[r];a&&"function"==typeof a&&1==a.late&&(s[r]=a.apply(i||this,s))}return o.apply(i||this,s)}},Date.prototype.format=function(t){var e,r,n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(e in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+e+")").test(t)&&(r=1==RegExp.$1.length?n[e]:("00"+n[e]).substr((""+n[e]).length),t=t.replace(RegExp.$1,r));return t},HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,r){for(var n=atob(this.toDataURL(e,r).split(",")[1]),a=n.length,o=new Uint8Array(a),i=0;i<a;i++)o[i]=n.charCodeAt(i);t(new Blob([o],{type:e||"image/png"}))}}),function(a){a.apply=function(t,e,r){for(var n in e)t[n]=e[n];return r?a.apply(t,r):t},a.loadScript=function(t,e,r){var n=document.createElement("script");n.src=t,r&&(n.onload=r),e&&(n.id=e),document.getElementsByTagName("head")[0].appendChild(n)},a.parallel=function(t,r){for(var e,n=0,a=Array(t.length).fill().map(function(){return{isActive:!1,data:null}}),o=function(e){return function(t){a[e].data=t,a[e].isActive=!0,a.every(function(t){return!0===t.isActive})&&(t=a.map(function(t){return t.data}),r(t))}};e=t.shift();)e(o(n)),n++},a.throttle=function(n,a,o){var i,s;return function(){var t,e=this,r=+new Date;window.clearTimeout(i),o<=r-(s=s||r)?(n.apply(this,arguments),s=r):(t=arguments,i=window.setTimeout(function(){return n.apply(e,t)},a))}},a.SELECTED="selected",a.SELECTED_CSS="."+a.SELECTED}(aj=aj||{}),function(aj){var xhr;!function(xhr_1){function json2url(t,e){var r,n=new Array;for(r in t)n.push(r+"="+t[r]);var a=n.join("&");return e&&(a=~e.indexOf("?")?e+"&"+n:e+"?"+n),a}function request(t,e,r,n,a){void 0===n&&(n="GET");var o=r?json2url(r):"",r=new XMLHttpRequest;"POST"==(n=n.toUpperCase())||"PUT"==n?r.open(n,t):r.open(n,t+(o?"?"+o:"")),e.url=t,r.onreadystatechange=requestCallback.delegate(null,e,a&&a.parseContentType),r.setRequestHeader("Accept","application/json"),"POST"==n||"PUT"==n?(r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(o)):r.send(null)}function serializeForm(t,r){var n={};return new FormData(t).forEach(function(t,e){r&&r.ignoreField!=e&&(n[e]=encodeURIComponent(t.toString()))}),n}function form(t,e,r){if(e=e||xhr_1.defaultCallBack,r=r||{},t){if("string"==typeof t&&(t=document.body.$(t)),!t.action)throw"Please fill the url in ACTION attribute.";var n;r.noFormValid||aj.form.Validator(t),r.googleReCAPTCHA&&(document.body.$("#googleReCAPTCHA")||(n="https://www.recaptcha.net/recaptcha/api.js?render=",n+=r.googleReCAPTCHA,aj.loadScript(n,"googleReCAPTCHA"))),t.addEventListener("submit",formSubmit.delegate(null,e,r));t=t.$("button.returnBtn");t&&(t.onclick=goBack)}}function formSubmit(t,e,r){t.preventDefault();var n,a=t.target,t=(t=a.getAttribute("method"))&&t.toLowerCase();r.method=t||r.method||"post",(r.noFormValid||aj.form.Validator.onSubmit(a))&&(n=serializeForm(a,r),r&&r.beforeSubmit&&!1===r.beforeSubmit(a,n)||(r.googleReCAPTCHA?grecaptcha.ready(function(){grecaptcha.execute(r.googleReCAPTCHA,{action:"submit"}).then(function(t){n.grecaptchaToken=t,"put"==r.method?xhr_1.put(a.action,e,n):xhr_1.post(a.action,e,n)})}):r&&"put"==r.method?xhr_1.put(a.action,e,n):xhr_1.post(a.action,e,n)))}function goBack(t){t.preventDefault(),history.back()}function requestCallback(event,cb,parseContentType){if(4===this.readyState&&200===this.status){var responseText=this.responseText.trim(),data=null;try{if(!responseText)throw"服务端返回空的字符串!";switch(parseContentType){case"text":data=responseText;break;case"xml":data=this.responseXML;break;case"json":default:try{data=JSON.parse(responseText)}catch(e){try{data=eval("TEMP_VAR = "+responseText)}catch(e){throw e}}}}catch(e){aj.alert("XHR 错误:\n"+e+"\nUrl is:"+cb.url)}if(!cb)throw"你未提供回调函数";cb(data,this)}4===this.readyState&&500==this.status&&aj.alert("服务端 500 错误！")}xhr_1.json2url=json2url,xhr_1.request=request,xhr_1.serializeForm=serializeForm,xhr_1.form=form,xhr_1.get=function(t,e,r,n){return aj.xhr.request(t,e,r,"GET",n)},xhr_1.post=function(t,e,r,n){return aj.xhr.request(t,e,r,"POST",n)},xhr_1.put=function(t,e,r,n){return aj.xhr.request(t,e,r,"PUT",n)},xhr_1.dele=function(t,e,r,n){return aj.xhr.request(t,e,r,"DELETE",n)},xhr_1.defaultCallBack=function(t,e,r,n){t?t.isOk?(r&&r(t),aj.msg.show(t.msg||"操作成功！")):(n&&n(t),aj.msg(t.msg||"执行失败！原因未知！")):(n&&n(t),aj.msg.show("ServerSide Error!"))}}(xhr=aj.xhr||(aj.xhr={}))}(aj=aj||{});
//# sourceMappingURL=../sourcemap/base.min.js.map
