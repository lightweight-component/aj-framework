"use strict";Raphael.el.addClass=function(t){return this.node.setAttribute("class",t),this},function(h){var t,e;function o(){}t=h.svg||(h.svg={}),o.connPoint=function(t,e){var o,n,r=e,s=t.x+t.width/2,i=t.y+t.height/2,h=(i-r.y)/(s-r.x),h=isNaN(h)?0:h,a=t.height/t.width,e=r.y<i?-1:1,r=r.x<s?-1:1;return Math.abs(h)>a&&-1==e?(o=i-t.height/2,n=s+e*t.height/2/h):Math.abs(h)>a&&1==e?(o=i+t.height/2,n=s+e*t.height/2/h):Math.abs(h)<a&&-1==r?(o=i+r*t.width/2*h,n=s-t.width/2):Math.abs(h)<a&&1==r&&(o=i+t.width/2*h,n=s+t.width/2),{x:n,y:o}},o.center=function(t,e){return{x:(t.x-e.x)/2+e.x,y:(t.y-e.y)/2+e.y}},o.isLine=function(t,e,o){t=t.x-o.x==0?1:(t.y-o.y)/(t.x-o.x),o=(e.x-o.x)*t+o.y;return e.y-o<10&&-10<e.y-o&&(e.y=o,!0)},o.arrow=function(t,e,o){var n=Math.atan2(t.y-e.y,e.x-t.x)*(180/Math.PI),r=e.x-o*Math.cos(n*(Math.PI/180)),t=e.y+o*Math.sin(n*(Math.PI/180));return[e,{x:r+o*Math.cos((120+n)*(Math.PI/180)),y:t-o*Math.sin((120+n)*(Math.PI/180))},{x:r+o*Math.cos((240+n)*(Math.PI/180)),y:t-o*Math.sin((240+n)*(Math.PI/180))}]},e=o,t.Utils=e,h.svg.createTextNode=function(t,e,o){var n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.textContent="{{value}}",n.setAttributeNS(null,"x",e),n.setAttributeNS(null,"y",o),h("svg").appendChild(n),new Vue({el:n,data:"string"==typeof t?{value:t}:t,methods:{setXY:function(t,e){this.$el.setAttributeNS(null,"x",t),this.$el.setAttributeNS(null,"y",e)},getXY:function(){return{x:Number(this.$el.getAttribute("x")),y:Number(this.$el.getAttribute("y"))}},setXY_vBox:function(t){var e=t.x+t.width/2,o=t.y+t.height/2,t=this.$el.getBoundingClientRect();this.setXY(e-t.width/2,o+5)}}})},h.svg.serialize={keyValue:function(t,e,o){o&&(o=o.replace(/>/g,"#5").replace(/</g,"#6").replace(/&/g,"#7"),t.push(" "+e+'="'+o+'"'))},rect:{toJson:function(t,e,o){var n,r="{type:'"+t.type+"',text:{text:'"+e.attr("text")+"'}, attr:{ x:"+Math.round(o.attr("x"))+", y:"+Math.round(o.attr("y"))+", width:"+Math.round(o.attr("width"))+", height:"+Math.round(o.attr("height"))+"}, props:{";for(n in t.props)r+=n+":{value:'"+t.props[n].value+"'},";return","==r.substring(r.length-1,r.length)&&(r=r.substring(0,r.length-1)),r+="}}"},toBeforeXml:function(t){var e,o,n=[" <",t.type,' layout="'+(Math.round(t.svg.attr("x"))-180),",",Math.round(t.svg.attr("y")),",",Math.round(t.svg.attr("width")),",",Math.round(t.svg.attr("height")),'"'],r=h.svg.serialize.keyValue;for(o in t.wfData){if(e=t.wfData[o].value,"name"==o&&!e)return h.alert(t.type+" 名称 不能为空"),"";"layout"!==o&&r(n,o,e)}return n.push(">"),n.join("")}},path:{toJson:function(t,e,o,n,r){var s,i="{from:'"+t.getId()+"',to:'"+e.getId()+"', dots:"+o.toJson()+",text:{text:'"+n.attr("text")+"'},textPos:{_dotList:"+Math.round(r.x)+",_ox:"+Math.round(r.y)+"}, props:{";for(s in _o.props)i+=s+":{value:'"+_o.props[s].value+"'},";return","==i.substring(i.length-1,i.length)&&(i=i.substring(0,i.length-1)),i+="}}"},toXml:function(t,e){var o=['<transition offset="" to="',t.to().vue.id,'" '],n=h.svg.serialize.dotList.toXml(t.fromDot);""!=n&&o.push(' g="'+n+'" ');var r,s,i=h.svg.serialize.keyValue;for(s in t.wfData)r=t.wfData[s].value,"name"!==s||""!=r?i(o,s,r):o.push(s+'="'+_id+'" ');return o.push("/>"),o.join("")}},dotList:{toJson:function(t){for(var e="[",o=t;o;)o.type===h.svg.Dot.BIG&&(e+="{x:"+Math.round(o.pos().x)+",y:"+Math.round(o.pos().y)+"},"),o=o.right();return","==e.substring(e.length-1,e.length)&&(e=e.substring(0,e.length-1)),e+="]"},toXml:function(t){for(var e="",o=t;o;)o.type===h.svg.Dot.BIG&&(e+=Math.round(o.pos().x)-180+","+Math.round(o.pos().y)+";"),o=o.right();return";"==e.substring(e.length-1,e.length)&&(e=e.substring(0,e.length-1)),e}}}}(aj=aj||{}),function(t){function e(){this.id=""}(t.svg||(t.svg={})).BaseComponent=e}(aj=aj||{});var aj,__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();!function(t){var u,l,p;function g(t,e,o,n,r){var s,i,h=l.call(this)||this,a=PAPER.rect(e.x-p,e.y-p);return a.addClass("dot"),h.svg=a,h.type=t,h._leftDot=o,h._rightDot=n,h._pos=e,h.path=r,t!=g.BIG&&t!=g.SMALL||a.drag(function(t,e){return h.moveTo(s+t,i+e)},function(){s=a.attr("x")+p,i=a.attr("y")+p}),h}u=t.svg||(t.svg={}),p=3,l=u.BaseComponent,__extends(g,l),g.prototype.left=function(t){return t&&(this._leftDot=t),this._leftDot},g.prototype.right=function(t){return t&&(this._rightDot=t),this._rightDot},g.prototype.remove=function(){this._leftDot=this._rightDot=null,this.svg.remove()},g.prototype.pos=function(t){return!t||isNaN(t.x)||isNaN(t.y)||(this._pos=t,this.svg.attr({x:t.x-p,y:t.y-p})),this._pos},g.prototype.moveTo=function(t,e){var o,n=this.pos({x:t,y:e}),r=this.path,s=this.left(),i=this.right(),h=i&&i.right(),a=s&&s.left();switch(this.type){case g.FROM:h&&h.type==g.TO&&h.pos(u.Utils.connPoint(r.to().getBBox(),n)),i&&h&&i.pos(u.Utils.center(n,h.pos()));break;case g.BIG:h&&h.type==g.TO&&h.pos(u.Utils.connPoint(r.to().getBBox(),n)),a&&a.type==g.FROM&&a.pos(u.Utils.connPoint(r.from().getBBox(),n)),h&&null!=i&&i.pos(u.Utils.center(n,h.pos())),a&&null!=s&&s.pos(u.Utils.center(n,a.pos())),u.Utils.isLine(null==a?void 0:a.pos(),n,null==h?void 0:h.pos())&&(this.type=g.SMALL,this.svg.attr({width:5,height:5,stroke:"#fff",fill:"#000",cursor:"move","stroke-width":3}),o=s,a.right(s.right()),this._leftDot=s=a,null!=o&&o.remove(),o=i,h.left(i.left()),this._rightDot=i=h,o.remove());break;case g.SMALL:s&&i&&!u.Utils.isLine(s.pos(),n,i.pos())&&(this.type=g.BIG,this.svg.attr({width:5,height:5,stroke:"#fff",fill:"#000",cursor:"move","stroke-width":2}),o=new g(g.SMALL,u.Utils.center(s.pos(),n),s,s.right(),r),s.right(o),this._leftDot=s=o,o=new g(g.SMALL,u.Utils.center(i.pos(),n),i.left(),i,r),i.left(o),this._rightDot=i=o);break;case g.TO:a&&a.type==g.FROM&&a.pos(u.Utils.connPoint(r.from().getBBox(),n)),a&&s.pos(u.Utils.center(n,a.pos()))}r.refreshPath()},g.prototype.toJson=function(){return""},g.prototype.show=function(){},g.prototype.hide=function(){},t=g,(u.Dot=t).TO=1,t.FROM=2,t.SMALL=3,t.BIG=4}(aj=aj||{});
//# sourceMappingURL=../sourcemap/workflow.min.js.map
