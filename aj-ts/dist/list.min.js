"use strict";var aj;Vue.component("aj-attachment-picture-list",{template:html(__makeTemplateObject(['\n        <table>\n            <tr>\n                <td>\n                    <div class="label">相册图：</div>\n                    <ul>\n                        <li v-for="pic in pics" style="float:left;margin-right:1%;text-align:center;">\n                            <a :href="picCtx + pic.path" target="_blank"><img :src="picCtx + pic.path" style="max-width: 100px;max-height: 100px;" /></a><br />\n                            <a href="###" @click="delPic(pic.id);">删 除</a>\n                        </li>\n                    </ul>\n                </td> \n                <td>\n                    <aj-xhr-upload ref="attachmentPictureUpload" :action="uploadUrl" :is-img-upload="true" :img-place="blankBg"></aj-xhr-upload>\n                </td>\n            </tr>\n        </table>\n    '],['\n        <table>\n            <tr>\n                <td>\n                    <div class="label">相册图：</div>\n                    <ul>\n                        <li v-for="pic in pics" style="float:left;margin-right:1%;text-align:center;">\n                            <a :href="picCtx + pic.path" target="_blank"><img :src="picCtx + pic.path" style="max-width: 100px;max-height: 100px;" /></a><br />\n                            <a href="###" @click="delPic(pic.id);">删 除</a>\n                        </li>\n                    </ul>\n                </td> \n                <td>\n                    <aj-xhr-upload ref="attachmentPictureUpload" :action="uploadUrl" :is-img-upload="true" :img-place="blankBg"></aj-xhr-upload>\n                </td>\n            </tr>\n        </table>\n    '])),props:{picCtx:String,uploadUrl:String,blankBg:String,delImgUrl:String,apiUrl:String},data:function(){return{pics:[]}},mounted:function(){this.getData(),this.$refs.attachmentPictureUpload.uploadOk_callback=this.getData},methods:{getData:function(){var e=this;aj.xhr.get(this.apiUrl,function(t){return e.pics=t.result})},delPic:function(t){var e=this;aj.showConfirm("确定删除相册图片？",function(){aj.xhr.dele(e.delImgUrl+t+"/",function(t){t.isOk&&e.getData()})})}}}),function(t){t.grid||(t.grid={}),Vue.component("aj-simple-grid",{template:html(__makeTemplateObject(['\n            <div>\n                <form action="?" method="GET" style="float:right;">\n                    <input type="hidden" name="searchField" value="content" />\n                    <input type="text" name="searchValue" placeholder="请输入搜索之关键字" class="aj-input" />\n                    <button style="margin-top: 0;" class="aj-btn">搜索</button>\n                </form>\n                <table class="aj-grid ajaxjs-borderTable">\n                    <thead>\n                        <tr>\n                            <th v-for="key in columns" @click="sortBy(key)" :class="{ active: sortKey == key }">\n                                {{ key | capitalize }}\n                                <span class="arrow" :class="sortOrders[key] > 0 ? \'asc\' : \'dsc\'"></span>\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="entry in filteredData">\n                            <td v-for="key in columns" v-html="entry[key]"></td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        '],['\n            <div>\n                <form action="?" method="GET" style="float:right;">\n                    <input type="hidden" name="searchField" value="content" />\n                    <input type="text" name="searchValue" placeholder="请输入搜索之关键字" class="aj-input" />\n                    <button style="margin-top: 0;" class="aj-btn">搜索</button>\n                </form>\n                <table class="aj-grid ajaxjs-borderTable">\n                    <thead>\n                        <tr>\n                            <th v-for="key in columns" @click="sortBy(key)" :class="{ active: sortKey == key }">\n                                {{ key | capitalize }}\n                                <span class="arrow" :class="sortOrders[key] > 0 ? \'asc\' : \'dsc\'"></span>\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="entry in filteredData">\n                            <td v-for="key in columns" v-html="entry[key]"></td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        '])),props:{data:Array,columns:Array,filterKey:String},data:function(){var e={};return this.columns.forEach(function(t){return e[t]=1}),{sortKey:"",sortOrders:e}},computed:{filteredData:function(){var n=this.sortKey,i=this.filterKey&&this.filterKey.toLowerCase(),a=this.sortOrders[n]||1,t=this.data;return i&&(t=t.filter(function(e){return Object.keys(e).some(function(t){return-1<String(e[t]).toLowerCase().indexOf(i)})})),n&&(t=t.slice().sort(function(t,e){return((t=t[n])===(e=e[n])?0:e<t?1:-1)*a})),t}},filters:{capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{sortBy:function(t){this.sortKey=t,this.sortOrders[t]=-1*this.sortOrders[t]}}})}(aj=aj||{}),function(n){var t;(t=n.list||(n.list={})).datastore={props:{apiUrl:{type:String,required:!0},isPage:{type:Boolean,default:!0},initPageSize:{type:Number,required:!1,default:9},isAutoLoad:{type:Boolean,default:!0},baseParam:{type:Object,default:function(){return{}}},pageParamNames:{type:Array,default:function(){return["start","limit"]}},onLoad:Function},data:function(){return{result:[],extraParam:{},pageSize:this.initPageSize,total:0,totalPage:0,pageStart:0,currentPage:0}},methods:{jumpPageBySelect:function(t){t=t.target,t=t.options[t.selectedIndex].value;this.pageStart=(Number(t)-1)*this.pageSize,this.getData()},onPageSizeChange:function(t){this.pageSize=Number(t.target.value),this.count(),this.getData()},count:function(){var t=this.total/this.pageSize,e=this.total%this.pageSize;this.totalPage=parseInt(String(0==e?t:1+t)),this.currentPage=parseInt(this.pageStart/this.pageSize+1)},previousPage:function(){this.pageStart-=this.pageSize,this.currentPage=parseInt(this.pageStart/this.pageSize+1),this.getData()},nextPage:function(){this.pageStart+=this.pageSize,this.currentPage=this.pageStart/this.pageSize+1,this.getData()}}},Vue.component("aj-list",{mixins:[t.datastore],template:html(__makeTemplateObject(['\n\t\t\t<div class="aj-list">\n\t\t\t\t<slot name="header" v-if="total != 0"></slot>\n\t\t\t\t<ul v-if="showDefaultUi && (total != 0)">\n\t\t\t\t\t<li v-for="(item, index) in result">\n\t\t\t\t\t\t<slot v-bind="item">\n\t\t\t\t\t\t\t<a href="#" @click="show(item.id, index, $event)" :id="item.id">{{item.name}}</a>\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="no-data" v-show="isPage && total == 0">未有任何数据</div>\n\t\t\t\t<footer v-if="isPage" class="pager">\n\t\t\t\t\t<a v-if="pageStart > 0" href="#" @click="previousPage">上一页</a>\n\t\t\t\t\t<a v-if="(pageStart > 0 ) && (pageStart + pageSize < total)" style="text-decoration: none;">&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</a>\n\t\t\t\t\t<a v-if="pageStart + pageSize < total" href="#" @click="nextPage">下一页</a>\n\t\t\t\t\t<a href="javascript:;" @click="getData"><i class="fa fa-refresh" aria-hidden="true"></i> 刷新</a>\n\t\t\t\t\t<input type="hidden" name="start" :value="pageStart" />\n\t\t\t\t\t页数：{{currentPage}}/{{totalPage}} 记录数：{{pageStart}}/{{total}}\n\t\t\t\t\t每页记录数： <input size="2" title="输入一个数字确定每页记录数" type="text" :value="pageSize" @change="onPageSizeChange" />\n\t\t\t\t\t跳转：\n\t\t\t\t\t<select @change="jumpPageBySelect">\n\t\t\t\t\t\t<option :value="n" v-for="n in totalPage">{{n}}</option>\n\t\t\t\t\t</select>\n\t\t\t\t</footer>\n\t\t\t\t<div v-show="!!autoLoadWhenReachedBottom" class="buttom"></div>\n\t\t\t</div>\n\t\t'],['\n\t\t\t<div class="aj-list">\n\t\t\t\t<slot name="header" v-if="total != 0"></slot>\n\t\t\t\t<ul v-if="showDefaultUi && (total != 0)">\n\t\t\t\t\t<li v-for="(item, index) in result">\n\t\t\t\t\t\t<slot v-bind="item">\n\t\t\t\t\t\t\t<a href="#" @click="show(item.id, index, $event)" :id="item.id">{{item.name}}</a>\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="no-data" v-show="isPage && total == 0">未有任何数据</div>\n\t\t\t\t<footer v-if="isPage" class="pager">\n\t\t\t\t\t<a v-if="pageStart > 0" href="#" @click="previousPage">上一页</a>\n\t\t\t\t\t<a v-if="(pageStart > 0 ) && (pageStart + pageSize < total)" style="text-decoration: none;">&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;</a>\n\t\t\t\t\t<a v-if="pageStart + pageSize < total" href="#" @click="nextPage">下一页</a>\n\t\t\t\t\t<a href="javascript:;" @click="getData"><i class="fa fa-refresh" aria-hidden="true"></i> 刷新</a>\n\t\t\t\t\t<input type="hidden" name="start" :value="pageStart" />\n\t\t\t\t\t页数：{{currentPage}}/{{totalPage}} 记录数：{{pageStart}}/{{total}}\n\t\t\t\t\t每页记录数： <input size="2" title="输入一个数字确定每页记录数" type="text" :value="pageSize" @change="onPageSizeChange" />\n\t\t\t\t\t跳转：\n\t\t\t\t\t<select @change="jumpPageBySelect">\n\t\t\t\t\t\t<option :value="n" v-for="n in totalPage">{{n}}</option>\n\t\t\t\t\t</select>\n\t\t\t\t</footer>\n\t\t\t\t<div v-show="!!autoLoadWhenReachedBottom" class="buttom"></div>\n\t\t\t</div>\n\t\t'])),props:{showDefaultUi:{type:Boolean,default:!0},isShowFooter:{type:Boolean,default:!0},hrefStr:{type:String,required:!1},autoLoadWhenReachedBottom:{type:String,default:""},isDataAppend:{type:Boolean,default:!1}},mounted:function(){this.isAutoLoad&&this.getData(),this.autoLoadWhenReachedBottom},methods:{getData:function(){var e=this;this.lastRequestParam={},n.apply(this.lastRequestParam,this.baseParam),n.apply(this.lastRequestParam,this.extraParam),function(){var t={};t[this.pageParamNames[0]]=this.pageStart,t[this.pageParamNames[1]]=this.pageSize,this.isPage&&n.apply(this.lastRequestParam,t)}.call(this),n.xhr.get(this.apiUrl,this.onLoad||function(t){t.result&&(e.isPage&&void 0===t.total&&n.alert("JSON 缺少 total 字段"),0!=t.total&&0!=t.result.length||n.alert("没有找到任何记录"),e.result=t.result,e.isPage&&(e.total=t.total,e.count())),e.$emit("pager-result",e.result)},this.lastRequestParam)},reset:function(){this.total=this.totalPage=this.pageStart=this.currentPage=0,this.pageSize=this.initPageSize},onExtraParamChange:function(t){n.apply(this.extraParam,t),this.pageStart=0,this.getData()}},watch:{extraParam:function(){this.getData()}}})}(aj=aj||{}),function(t){t.grid||(t.grid={}),Vue.component("aj-simple-grid",{template:html(__makeTemplateObject(['\n            <div>\n                <form action="?" method="GET" style="float:right;">\n                    <input type="hidden" name="searchField" value="content" />\n                    <input type="text" name="searchclassValue" placeholder="请输入搜索之关键字" class="aj-input" />\n                    <button style="margin-top: 0;" class="aj-btn">搜索</button>\n                </form>\n                <table class="aj-grid aj-table" style="clear: both;width:100%">\n                    <thead>\n                        <tr>\n                            <th v-for="key in columns" @click="sortBy(key)" :class="{ active: sortKey == key }">\n                                {{ key | capitalize }}\n                                <span class="arrow" :class="sortOrders[key] > 0 ? \'asc\' : \'dsc\'"></span>\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="entry in filteredData">\n                            <td v-for="key in columns" v-html="entry[key]"></td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        '],['\n            <div>\n                <form action="?" method="GET" style="float:right;">\n                    <input type="hidden" name="searchField" value="content" />\n                    <input type="text" name="searchclassValue" placeholder="请输入搜索之关键字" class="aj-input" />\n                    <button style="margin-top: 0;" class="aj-btn">搜索</button>\n                </form>\n                <table class="aj-grid aj-table" style="clear: both;width:100%">\n                    <thead>\n                        <tr>\n                            <th v-for="key in columns" @click="sortBy(key)" :class="{ active: sortKey == key }">\n                                {{ key | capitalize }}\n                                <span class="arrow" :class="sortOrders[key] > 0 ? \'asc\' : \'dsc\'"></span>\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr v-for="entry in filteredData">\n                            <td v-for="key in columns" v-html="entry[key]"></td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        '])),props:{data:Array,columns:Array,filterKey:String},data:function(){var e={};return this.columns.forEach(function(t){return e[t]=1}),{sortKey:"",sortOrders:e}},computed:{filteredData:function(){var n=this.sortKey,i=this.filterKey&&this.filterKey.toLowerCase(),a=this.sortOrders[n]||1,t=this.data;return i&&(t=t.filter(function(e){return Object.keys(e).some(function(t){return-1<String(e[t]).toLowerCase().indexOf(i)})})),n&&(t=t.slice().sort(function(t,e){return((t=t[n])===(e=e[n])?0:e<t?1:-1)*a})),t}},filters:{capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{sortBy:function(t){this.sortKey=t,this.sortOrders[t]=-1*this.sortOrders[t]}}})}(aj=aj||{}),Vue.component("aj-grid-select-row",{template:'<a href="#" @click="fireSelect">选择</a>',props:{type:{type:String,required:!0}},methods:{fireSelect:function(){this.BUS.$emit("on-"+this.type+"-select",this.$parent.form)}}}),Vue.component("aj-grid-open-link",{template:'<a href="#" @click="fireSelect"><i class="fa fa-external-link"></i> 详情</a>',methods:{fireSelect:function(){this.BUS.$emit("on-open-link-clk",this.$parent.form)}}}),function(a){var t;!function(e){e.SectionModel={data:function(){return{isSelectAll:!1,selected:{},selectedTotal:0,maxRows:0}},mounted:function(){this.BUS&&this.BUS.$on("on-delete-btn-clk",this.batchDelete)},methods:{batchDelete:function(){var e=this;0<this.selectedTotal?a.showConfirm("确定批量删除记录？",function(){for(var t in e.selected)a.xhr.dele(e.apiUrl+"/"+t+"/",function(t){console.log(t)})}):a.alert("未选择记录")},selectAll:function(){var e=this;this.$el.$("table .selectCheckbox input[type=checkbox]",this.selectedTotal===this.maxRows?function(t){t.checked=!1;t=t.dataset.id;if(!t)throw"需要提供 id 在 DOM 属性中";e.$set(e.selected,Number(t),!1)}:function(t){t.checked=!0;t=t.dataset.id;if(!t)throw"需要提供 id 在 DOM 属性中";e.$set(e.selected,Number(t),!0)})}},watch:{selected:{handler:function(t){var e,n=0;for(e in this.selected)!1===this.selected[e]?delete this.selected[e]:n++;(this.selectedTotal=n)===this.maxRows?this.$el.$(".top-checkbox").checked=!0:this.$el.$(".top-checkbox").checked=!1},deep:!0}}};var n,t=(n=a.VueComponent,__extends(i,n),i.prototype.data=function(){return{list:[],updateApi:null,showAddNew:!1}},i.prototype.mounted=function(){var e=this;this.$children.forEach(function(t){switch(t.$options._componentTag){case"aj-entity-toolbar":e.$toolbar=t;break;case"aj-grid-inline-edit-row":e.$row=t;break;case"aj-list":e.$store=t}}),this.$store.$on("pager-result",function(t){e.list=t,e.maxRows=t.length})},i.prototype.onCreateClk=function(){this.showAddNew=!0},i.prototype.reload=function(){this.$store.getData()},i.prototype.onDirtySaveClk=function(){var e=this,t=function(){var e=[];return this.list.forEach(function(t){t.dirty&&e.push(t)}),e}.call(this);t.length?t.forEach(function(t){a.xhr.put((e.updateUrl||e.apiUrl)+"/"+t.id+"/",function(t){t.isOk&&(e.list.forEach(function(t){t.dirty&&delete t.dirty}),a.msg.show("修改记录成功"))},t.dirty)}):a.msg.show("没有修改过的记录")},i);function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.name="aj-grid",t.template='<div class="aj-grid"><slot v-bind:grid="this"></slot></div>',t.mixins=[e.SectionModel],t.props={apiUrl:{type:String,required:!0},updateUrl:{type:String,required:!1}},t.$store=null,t.$toolbar=null,t.$row=null,t.showAddNew=!1,t.list=[],t.apiUrl="",t.updateUrl="",t.maxRows=0,t.selected={},t}(new(e.Grid=t)).register()}((t=a.list||(a.list={})).grid||(t.grid={}))}(aj=aj||{}),function(i){var t,e;function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="aj-grid-inline-edit-row-create",t.template=html(__makeTemplateObject(['\n            <tr class="aj-grid-inline-edit-row isEditMode">\n                <td></td>\n                <td></td>\n                <td v-for="key in columns" style="padding:0" class="cell">\n                    <aj-select v-if="key != null && key.type == \'select\'" :name="key.name" :options="key.data"  style="width: 200px;"></aj-select>\n                    <input v-if="key != null && !key.type" type="text" size="0" :name="key" style="background-color:white" />\n                </td>\n                <td class="control">\n                    <span @click="addNew"><i class="fa fa-plus" style="color:#080;"></i> 新增</span>\n                    <span @click="$parent.showAddNew = false"><i class="fa fa-undo" style="color:#bc49eb;"></i> 撤销</span>\n                </td>\n            </tr>\n        '],['\n            <tr class="aj-grid-inline-edit-row isEditMode">\n                <td></td>\n                <td></td>\n                <td v-for="key in columns" style="padding:0" class="cell">\n                    <aj-select v-if="key != null && key.type == \'select\'" :name="key.name" :options="key.data"  style="width: 200px;"></aj-select>\n                    <input v-if="key != null && !key.type" type="text" size="0" :name="key" style="background-color:white" />\n                </td>\n                <td class="control">\n                    <span @click="addNew"><i class="fa fa-plus" style="color:#080;"></i> 新增</span>\n                    <span @click="$parent.showAddNew = false"><i class="fa fa-undo" style="color:#bc49eb;"></i> 撤销</span>\n                </td>\n            </tr>\n        '])),t.props={columns:{type:Array,required:!0},createApi:{type:String,required:!1,default:"."}},t.createApi="",t.$parent=null,t}(t=i.list||(i.list={})).grid||(t.grid={}),(new(e=i.VueComponent,__extends(n,e),n.prototype.addNew=function(){var e=this,n={};this.$el.$("*[name]",function(t){return n[t.name]=t.value}),this.BUS.$emit("before-add-new",n),i.xhr.post(this.createApi,function(t){t&&t.isOk?(i.msg.show("新建实体成功"),e.$el.$("input[name]",function(t){t.value=""}),e.$parent&&(e.$parent.reload(),e.$parent.showAddNew=!1)):t&&t.msg&&i.msg.show(t.msg)},n)},n)).register()}(aj=aj||{}),function(n){var t,e;function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="aj-grid-inline-edit-row",t.template=html(__makeTemplateObject(['\n            <tr class="aj-grid-inline-edit-row" :class="{editing: isEditMode}">\n                <td v-if="showCheckboxCol" class="selectCheckbox">\n                    <input type="checkbox" @change="selectCheckboxChange" :data-id="id" />\n                </td>\n                <td v-if="showIdCol">{{id}}</td>\n                <td v-for="cellRenderer in columns" :style="styleModifly" class="cell" @dblclick="dbEdit">\n                    <span v-if="!isEditMode" v-html="renderCell(rowData, cellRenderer)"></span>\n                    <input v-if="canEdit(cellRenderer)" v-model="rowData[cellRenderer]" type="text" size="0" style="background-color:white;" />\n                    <span v-if="cellRenderer && cellRenderer.cmpName">\n                        <component v-if="!isEditMode || !cellRenderer.editMode" v-bind:is="cellRenderer.cmpName" v-bind="cellRenderer.cmpProps(rowData)"></component>\n                        <component v-if="isEditMode && cellRenderer.editMode" v-bind:is="cellRenderer.editCmpName" v-bind="cellRenderer.cmpProps(rowData)"></component> \n                    </span>\n                </td>\n                <td v-if="showControl" class="control">\n                    <aj-cell-renderer v-if="controlUi" :html="controlUi" :form="rowData"></aj-cell-renderer>\n                    <span @click="onEditClk" class="edit"><i class="fa fa-pencil" aria-hidden="true"></i>\n                        {{!isEditMode ? "编辑" : "确定"}}</span>\n                    <span @click="dele" class="delete"><i class="fa fa-times" aria-hidden="true"></i> 删除</span>\n                </td>\n            </tr>'],['\n            <tr class="aj-grid-inline-edit-row" :class="{editing: isEditMode}">\n                <td v-if="showCheckboxCol" class="selectCheckbox">\n                    <input type="checkbox" @change="selectCheckboxChange" :data-id="id" />\n                </td>\n                <td v-if="showIdCol">{{id}}</td>\n                <td v-for="cellRenderer in columns" :style="styleModifly" class="cell" @dblclick="dbEdit">\n                    <span v-if="!isEditMode" v-html="renderCell(rowData, cellRenderer)"></span>\n                    <input v-if="canEdit(cellRenderer)" v-model="rowData[cellRenderer]" type="text" size="0" style="background-color:white;" />\n                    <span v-if="cellRenderer && cellRenderer.cmpName">\n                        <component v-if="!isEditMode || !cellRenderer.editMode" v-bind:is="cellRenderer.cmpName" v-bind="cellRenderer.cmpProps(rowData)"></component>\n                        <component v-if="isEditMode && cellRenderer.editMode" v-bind:is="cellRenderer.editCmpName" v-bind="cellRenderer.cmpProps(rowData)"></component> \n                    </span>\n                </td>\n                <td v-if="showControl" class="control">\n                    <aj-cell-renderer v-if="controlUi" :html="controlUi" :form="rowData"></aj-cell-renderer>\n                    <span @click="onEditClk" class="edit"><i class="fa fa-pencil" aria-hidden="true"></i>\n                        {{!isEditMode ? "编辑" : "确定"}}</span>\n                    <span @click="dele" class="delete"><i class="fa fa-times" aria-hidden="true"></i> 删除</span>\n                </td>\n            </tr>'])),t.props={initRowData:{type:Object,required:!0},showIdCol:{type:Boolean,default:!0},showCheckboxCol:{type:Boolean,default:!0},showControl:{type:Boolean,default:!0},enableInlineEdit:{type:Boolean,default:!1},columns:Array,filterField:Array,deleApi:String,controlUi:String},t.filterField=[],t.id="",t.initRowData={},t.rowData={},t.isEditMode=!1,t.enableInlineEdit=!1,t.columns=[],t.$parent=null,t.computed={styleModifly:function(){return{padding:this.isEditMode?0:""}}},t}function a(l){return function(t){if(this.$parent){for(var e=this.$parent.list,n=void 0,i=0,a=e.length;i<a;i++)if(this.id&&String(e[i].id)==this.id){n=e[i];break}if(!n)throw"找不到匹配的实体！目标 id: "+this.id;n.dirty||(n.dirty={id:this.id}),n.dirty[l]=t}}}(t=n.list||(n.list={})).grid||(t.grid={}),Vue.component("foo",{template:"<div>foo</div>"}),(new(e=n.VueComponent,__extends(i,e),i.prototype.data=function(){return{id:this.initRowData.id,rowData:this.initRowData,isEditMode:!1}},i.prototype.mounted=function(){for(var t in this.rowData)this.$watch("rowData."+t,a.call(this,t))},i.prototype.selectCheckboxChange=function(t){var e=t.target,t=this.$parent;t&&(e.checked?t.$set(t.selected,this.id,!0):t.$set(t.selected,this.id,!1))},i.prototype.renderCell=function(t,e){var n="";return""===e||("string"==typeof e&&(n=t[e]+""),"function"==typeof e&&(n=e(t)),"object"==typeof e&&e.renderer&&(n=e.renderer(t))),n},i.prototype.canEdit=function(t){return this.isEditMode&&!function(t){if(this.filterField&&this.filterField.length)for(var e=0,n=this.filterField.length;e<n;e++)if(this.filterField[e]==t)return!0;return!1}.call(this,t)&&!t.editMode},i.prototype.rendererEditMode=function(t,e){return"string"==typeof e?e.toString():e.editMode&&"function"==typeof e.editRenderer?e.editRenderer(t):"NULL"},i.prototype.onEditClk=function(){this.enableInlineEdit?this.isEditMode=!this.isEditMode:this.$parent.onEditClk?this.$parent.onEditClk(this.id):this.$parent.$parent.onEditClk&&this.$parent.$parent.onEditClk(this.id)},i.prototype.dbEdit=function(t){var e;this.onEditClk(),this.enableInlineEdit&&this.isEditMode&&("TD"!==(e=t.target).tagName&&(e=e.up("td")),setTimeout(function(){var t;"INPUT"!==e.tagName&&(t=e.$("input")),t&&t.focus()},200))},i.prototype.dele=function(t){var e=this;n.showConfirm("确定删除记录 id:["+this.id+"] 吗？",function(){e.$parent&&n.xhr.dele(e.$parent.apiUrl+"/"+e.id+"/",function(t){t.isOk&&(n.msg.show("删除成功"),e.$parent&&e.$parent.reload())})})},i)).register()}(aj=aj||{}),function(e){var t;(t=e.list||(e.list={})).grid||(t.grid={}),Vue.component("aj-entity-toolbar",{template:html(__makeTemplateObject(['\n            <div class="toolbar">\n                <form v-if="search" class="right">\n                    <input type="text" name="keyword" placeholder="请输入关键字" size="12" />\n                    <button @click="doSearch"><i class="fa fa-search" style="color:#417BB5;"></i>搜索</button>\n                </form>\n                <aj-form-between-date v-if="betweenDate" class="right" :is-ajax="true"></aj-form-between-date>\n                <ul>\n                    <li v-if="create" @click="$emit(\'on-create-btn-clk\')"><i class="fa fa-plus" style="color:#0a90f0;"></i> 新建</li>\n                    <li v-if="save" @click="$emit(\'on-save-btn-clk\')"><i class="fa fa-floppy-o"\n                            style="color:rgb(205, 162, 4);"></i>保存</li>\n                    <li v-if="deleBtn" @click="$emit(\'on-delete-btn-clk\')"><i class="fa fa-trash-o" style="color:red;"></i> 删除</li>\n                    <li v-if="excel"><i class="fa fa-file-excel-o" style="color:green;"></i> 导出</li>\n                    <slot></slot>\n                </ul>\n            </div>\n        '],['\n            <div class="toolbar">\n                <form v-if="search" class="right">\n                    <input type="text" name="keyword" placeholder="请输入关键字" size="12" />\n                    <button @click="doSearch"><i class="fa fa-search" style="color:#417BB5;"></i>搜索</button>\n                </form>\n                <aj-form-between-date v-if="betweenDate" class="right" :is-ajax="true"></aj-form-between-date>\n                <ul>\n                    <li v-if="create" @click="$emit(\'on-create-btn-clk\')"><i class="fa fa-plus" style="color:#0a90f0;"></i> 新建</li>\n                    <li v-if="save" @click="$emit(\'on-save-btn-clk\')"><i class="fa fa-floppy-o"\n                            style="color:rgb(205, 162, 4);"></i>保存</li>\n                    <li v-if="deleBtn" @click="$emit(\'on-delete-btn-clk\')"><i class="fa fa-trash-o" style="color:red;"></i> 删除</li>\n                    <li v-if="excel"><i class="fa fa-file-excel-o" style="color:green;"></i> 导出</li>\n                    <slot></slot>\n                </ul>\n            </div>\n        '])),props:{betweenDate:{type:Boolean,default:!0},create:{type:Boolean,default:!0},save:{type:Boolean,default:!0},excel:{type:Boolean,default:!1},deleBtn:{type:Boolean,default:!0},search:{type:Boolean,default:!0}},methods:{doSearch:function(t){t.preventDefault(),e.apply(this.$parent.$store.extraParam,{keyword:e.form.utils.getFormFieldValue(this.$el,"input[name=keyword]")}),this.$parent.$store.reload()}}})}(aj=aj||{}),function(t){((t=t.list||(t.list={})).tree||(t.tree={})).findNodesHolder=function t(e,n){if(!n.shift)return null;var i,a=n.shift();for(i in e)if(i===a){var l=e[i];return 0==n.length?l:t(e[i],n)}return null}}(aj=aj||{}),function(n){var r,e,t;function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="aj-tree-like-select",t.template='<select :name="fieldName" class="aj-select" @change="onSelected" style="min-width:180px;"></select>',t.props={fieldName:{type:String,required:!1,default:"catalogId"},apiUrl:{type:String,default:function(){return n.ctx+"/admin/tree-like/"}},isAutoLoad:{type:Boolean,default:!0},isAutoJump:Boolean,initFieldValue:String},t.apiUrl="",t.isAutoJump=!1,t.isAutoLoad=!0,t.fieldName="",t.fieldValue="",t.initFieldValue="",t}function a(t,e,i,n){var a;n&&n.makeAllOption&&((a=document.createElement("option")).innerHTML=n.allOptionName||"全部分类",e.appendChild(a));var l,t=r.toTreeMap(t);t&&(l=document.createDocumentFragment(),console.log(t),r.output(t,function(t,e){var n=document.createElement("option");n.value=e,i&&i==e&&(n.selected=!0),n.dataset.pid=t.pid+"",n.innerHTML=new Array(5*t.level).join("&nbsp;")+(1==t.level?"":"└─")+t.name,l.appendChild(n)}),e.appendChild(l))}r=n.tree||(n.tree={}),e=n.VueComponent,__extends(i,e),i.prototype.data=function(){return{fieldValue:this.initFieldValue}},i.prototype.mounted=function(){this.isAutoLoad&&this.getData()},i.prototype.onSelected=function(t){var e=t.target;this.fieldValue=e.selectedOptions[0].value,this.isAutoJump?location.assign("?"+this.fieldName+"="+this.fieldValue):this.BUS&&this.BUS.$emit("aj-tree-catelog-select-change",t,this)},i.prototype.getData=function(){var e=this;n.xhr.get(this.apiUrl,function(t){a([{id:0,name:"请选择分类"}].concat(t.result),e.$el,e.fieldValue,{makeAllOption:!1}),e.fieldValue&&n.form.utils.selectOption.call(e,e.fieldValue)})},t=i,(new(r.TreeLikeSelect=t)).register(),r.rendererOption=a}(aj=aj||{}),function(t){!function(t){function r(t,e){for(var n=0,i=t.length;n<i;n++){var a=t[n];if(a.id==e)return a;if(a.children){a=r(a.children,e);if(null!=a)return a}}return null}function o(t,e){for(var n in t){if(n==e)return t[n];var i=t[n].children;if(i)for(var a=0,l=i.length;a<l;a++){var r=o(i[a],e);if(null!=r)return r}}return null}t.makeTree=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var a,l=t[n];-1===l.pid?e.push(l):(a=r(e,l.pid))?(a.children||(a.children=[]),a.children.push(l)):console.log("parent not found!")}return e},t.findParentInArray=r,t.findParentInMap=o;var s=[];function d(t,e){for(var n in s.push(t),t){t[n].level=s.length,e(t[n],n);var i=t[n].children;if(i)for(var a=0,l=i.length;a<l;a++)d(i[a],e)}s.pop()}function l(t){if(!t)return{};for(var e={},n=0,i=t.length;n<i;n++){var a,l=t[n],r=o(e,l.pid+"");null==r?e[l.id]=l:((a={})[l.id]=l,r.children||(r.children=[]),r.children.push(a))}return e}t.output=d,t.toTree=l,t.rendererOption=function(t,e,i,n){n&&n.makeAllOption&&((n=document.createElement("option")).value=n.innerHTML="全部分类",e.appendChild(n));var a=document.createDocumentFragment();d(l(t),function(t,e){var n=document.createElement("option");n.value=e,i&&i==e&&(n.selected=!0),n.dataset.pid=t.pid+"",n.innerHTML=new Array(5*t.level).join("&nbsp;")+(1==t.level?"":"└─")+t.name,a.appendChild(n)}),e.appendChild(a)}}((t=t.list||(t.list={})).tree||(t.tree={}))}(aj=aj||{}),function(t){var e,n,i;function a(){var t=null!==i&&i.apply(this,arguments)||this;return t.name="aj-tree-item",t.template=html(__makeTemplateObject(['\n            <li>\n                <div :class="{bold: isFolder, node: true}" @click="toggle">\n                    <span>········</span>{{model.name}}\n                    <span v-if="isFolder">[{{open ? \'-\' : \'+\'}}]</span>\n                </div>\n                <ul v-show="open" v-if="isFolder" :class="{show: open}">\n                    <aj-tree-item class="item" v-for="(model, index) in model.children" :key="index" :model="model">\n                    </aj-tree-item>\n                    <li v-if="allowAddNode" class="add" @click="addChild">+</li>\n                </ul>\n            </li>\n        '],['\n            <li>\n                <div :class="{bold: isFolder, node: true}" @click="toggle">\n                    <span>········</span>{{model.name}}\n                    <span v-if="isFolder">[{{open ? \'-\' : \'+\'}}]</span>\n                </div>\n                <ul v-show="open" v-if="isFolder" :class="{show: open}">\n                    <aj-tree-item class="item" v-for="(model, index) in model.children" :key="index" :model="model">\n                    </aj-tree-item>\n                    <li v-if="allowAddNode" class="add" @click="addChild">+</li>\n                </ul>\n            </li>\n        '])),t.props={model:Object,allowAddNode:{type:Boolean,default:!1}},t.model={children:[]},t.open=!1,t.allowAddNode=!1,t.computed={isFolder:function(){return!(!this.model.children||!this.model.children.length)}},t}e=t.list||(t.list={}),n=e.tree||(e.tree={}),i=t.VueComponent,__extends(a,i),a.prototype.toggle=function(){this.isFolder&&(this.open=!this.open),this.BUS&&this.BUS.$emit("tree-node-click",this.model)},a.prototype.changeType=function(){this.isFolder||(Vue.set(this.model,"children",[]),this.addChild(),this.open=!0)},a.prototype.addChild=function(){this.model.children.push({name:"new stuff"})},e=a,(new(n.TreeItem=e)).register()}(aj=aj||{}),function(r){!function(n){var e,t=(e=r.VueComponent,__extends(i,e),i.prototype.getData=function(){var e=this;r.xhr.get(this.apiUrl,function(t){e.treeData.children=n.toTreeArray(t.result)}),this.BUS&&this.BUS.$on("treenodeclick",function(t){return e.$emit("treenodeclick",t)})},i.prototype.mounted=function(){this.getData()},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="aj-tree",t.template='<ul class="aj-tree"><aj-tree-item :model="treeData"></aj-tree-item></ul>',t.props={apiUrl:String,topNodeName:String},t.topNodeName="",t.apiUrl="",t.isAutoLoad=!1,t.treeData={name:t.topNodeName||"TOP",children:null},t}(new(n.Tree=t)).register();var a,t=(a=r.VueComponent,__extends(l,a),l.prototype.toggle=function(){this.isFolder&&(this.open=!this.open),this.BUS&&this.BUS.$emit("tree-node-click",this.model)},l.prototype.changeType=function(){this.isFolder||(Vue.set(this.model,"children",[]),this.addChild(),this.open=!0)},l.prototype.addChild=function(){this.model.children.push({name:"new stuff"})},l);function l(){var t=null!==a&&a.apply(this,arguments)||this;return t.name="aj-tree-item",t.template=html(__makeTemplateObject(['\n                <li>\n                    <div :class="{bold: isFolder, node: true}" @click="toggle">\n                        <span>········</span>{{model.name}}\n                        <span v-if="isFolder">[{{open ? \'-\' : \'+\'}}]</span>\n                    </div>\n                    <ul v-show="open" v-if="isFolder" :class="{show: open}">\n                        <aj-tree-item class="item" v-for="(model, index) in model.children" :key="index" :model="model">\n                        </aj-tree-item>\n                        <li v-if="allowAddNode" class="add" @click="addChild">+</li>\n                    </ul>\n                </li>\n            '],['\n                <li>\n                    <div :class="{bold: isFolder, node: true}" @click="toggle">\n                        <span>········</span>{{model.name}}\n                        <span v-if="isFolder">[{{open ? \'-\' : \'+\'}}]</span>\n                    </div>\n                    <ul v-show="open" v-if="isFolder" :class="{show: open}">\n                        <aj-tree-item class="item" v-for="(model, index) in model.children" :key="index" :model="model">\n                        </aj-tree-item>\n                        <li v-if="allowAddNode" class="add" @click="addChild">+</li>\n                    </ul>\n                </li>\n            '])),t.props={model:Object,allowAddNode:{type:Boolean,default:!1}},t.model={children:[]},t.open=!1,t.allowAddNode=!1,t.computed={isFolder:function(){return!(!this.model.children||!this.model.children.length)}},t}(new(n.TreeItem=t)).register()}(r.tree||(r.tree={}))}(aj=aj||{}),function(t){((t=t.list||(t.list={})).tree||(t.tree={})).findNodesHolder=function t(e,n){if(!n.shift)return null;var i,a=n.shift();for(i in e)if(i===a){var l=e[i];return 0==n.length?l:t(e[i],n)}return null}}(aj=aj||{}),function(t){!function(t){function r(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(e==i.id)return i;i=i.children;if(i){i=r(i,e);if(null!=i)return i}}return null}function o(t,e){for(var n in t){var i=t[n];if(n==e)return i;if(null!==i){i=i.children;if(i){i=o(i,e);if(null!=i)return i}}}return null}t.findNodesHolder=function t(e,n){if(!n.shift)return null;var i,a=n.shift();for(i in e)if(i===a){var l=e[i];return 0==n.length?l:t(e[i],n)}return null},t.findParentInArray=r,t.toTreeArray=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var a,l=t[n];-1===l.pid?e.push(l):(a=r(e,l.pid))?(a.children||(a.children=[]),a.children.push(l)):console.log("parent not found!")}return e},t.findParentInMap=o,t.toTreeMap=function(t){if(!t)return null;for(var e={},n=0,i=t.length;n<i;n++){var a,l=t[n];-1===l.pid?e[l.id]=l:(a=o(e,l.pid+""))?(a.children||(a.children={}),a.children[l.id]=l):console.log("parent not found!")}return e};var l=[];t.output=function t(e,n){for(var i in l.push(e),e){e[i].level=l.length,n&&n(e[i],i);var a=e[i].children;a&&t(a,n)}l.pop()}}(t.tree||(t.tree={}))}(aj=aj||{});
//# sourceMappingURL=../sourcemap/list.min.js.map
