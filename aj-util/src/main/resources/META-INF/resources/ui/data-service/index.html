<html>

<head>
    <meta charset="utf-8" />
    <title>Data Service</title>

    <!-- import Vue.js -->
    <!--  <script src="https://unpkg.com/vue@2.6.14/dist/vue.min.js"></script> -->
    <script src="libs/vue.js"></script>
    <!-- import stylesheet -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/view-design/4.7.0/styles/iview.css" />
    <!-- import iView -->
    <script src="libs/iview.js"></script>
    <style type="text/less">
        body {
    overflow: hidden;
}

nav {
    height: 30px;
    line-height: 30px;
    padding: 0 15px;
    border-bottom: 1px solid white;
    background-color: #e3e3e3;
    background-image: linear-gradient(#fefefe, #d8d8d8);
    text-shadow: 1px 1px 1px white;
}

.split-pane-left {
   // padding: 3px;
}

.split-pane-right {
 padding-left: 5px;
 
}

.toolbar {
    border-bottom: 1px solid white;
    padding: 2px 15px;
    padding-top: 12px;
    background-color: #eaeaea;
    background-image: linear-gradient(#fefefe, #e6e6e6);
    text-shadow: 1px 1px 1px white;

    li {
        width: 50px;
        text-align: center;
        list-style: none;
        color: gray;
        
        display: inline-block;
        margin-right: 20px;

        &:hover {
            .text {
                color: black;
            }

            .icon {
                border-color: gray ;
            }

            cursor: pointer;
        }

        .icon {
            width:32px;
            border-radius: 3px;
            box-shadow: 1px 1px 1px white;
            border: 1px solid lightgray;
            margin: 0 auto;
            margin-bottom: 5px;
        }

        .text{
            font-size: .65rem;
        }
    }
}

.content{
    border-top: 1px solid lightgray;
    padding:1%;
}
.search-panel {
    border-bottom: 1px solid lightgray;
    background-image: linear-gradient(#fefefe, #e6e6e6);
    height:66px;padding-top:14px;text-align: center;

}

.status-bar {
    position: absolute;
    bottom: 0;
    left: 0;
}
.datasource {
    .left {
    float: left;
    width: 28%;
    height: 300px;
    border-right: 1px solid #f5f5f5;
    }

    .right {
    float: right;
    width: 70%;
    padding-left: 10px;
    }

    ul {
    margin: 0 2%;
    }

    li {
    border-bottom: 1px solid #f5f5f5;
    padding: 5px 8px;
    cursor: pointer;
    &.actived {
        font-weight: bold;
    }
    }

    .add {
    //   color: #2d8cf0;
    display: block;
    padding: 5px 10px;
    }
}

fieldset {
    margin: 20px 0;
    border: 0;
    border-top: 1px solid lightgray;
    padding: 10px 20px;
    legend {
      margin-left: 8px;
      font-weight:bold;
      letter-spacing: 5px;
    }
  }

  table.layout{
    border-collapse: collapse;
    border-spacing:0;

    td{
        border-collapse: collapse;
        border-spacing:0;
    }
  }

  ul.line-layout{
    li {
        display: inline-block;
        min-width: 200px;
        vertical-align: top;
        margin-right: 20px;
    }
  }
    </style>
    <!-- <script src="https://cdn.jsdelivr.net/npm/less"></script> -->
    <script src="libs/less.js"></script>
</head>

<body>
    <div class="data-service">
        <nav>
            <div style="float:right;">
                <a>首页</a> | <a href="https://framework.ajaxjs.com" target="_blank">帮助</a> | <a @click="showAbout">关于</a>
            </div>
            数据服务 Data Service
        </nav>
        <Split v-model="split1" style="border-top: 1px solid lightgray;">
            <div slot="left" class="split-pane-left">
                <div class="search-panel ">
                    <i-Input suffix="ios-search" placeholder="搜索数据服务……" style="width: 90%" />
                </div>

                <i-Select v-model="datasource.id" style="margin: 15px 8px;width: 91%;" placeholder="请选择数据源">
                    <Option v-for="item in datasource.list" :key="item.id" :value="item.id">{{ item.name }}</Option>
                </i-Select>

                <Tree :data="treeData" style="margin-left: 10px;"></Tree>
            </div>
            <div slot="right" class="split-pane-right">

                <ul class="toolbar">
                    <li style="float:right" @click="refreshConfig">
                        <div>
                            <div class="icon">
                                <Icon type="md-refresh" size="25" style="color:darkcyan" />
                            </div>
                            <span class="text">
                                刷新配置
                            </span>
                        </div>
                    </li>
                    <li style="float:right" @click="isShowDataSource=true">
                        <div>
                            <div class="icon">
                                <Icon type="md-swap" size="25" style="color:blueviolet" />
                            </div>
                            <span class="text">
                                数据源
                            </span>
                        </div>
                    </li>
                    <li>
                        <div>
                            <div class="icon">
                                <Icon type="md-add" size="25" style="color:green" />
                            </div>
                            <span class="text">
                                新建服务
                            </span>
                        </div>
                    </li>
                    <li>
                        <div>
                            <div class="icon">
                                <Icon type="md-close" size="25" style="color:red" />
                            </div>
                            <span class="text">
                                删除
                            </span>
                        </div>
                    </li>
                    <li>
                        <div>
                            <div class="icon">
                                <Icon type="ios-add" size="25" style="color:cadetblue" />
                            </div>
                            <span class="text">
                                新建命令
                            </span>
                        </div>
                    </li>
                    <li>
                        <div>
                            <div class="icon">
                                <Icon type="ios-create" size="25" style="color:#f90" />
                            </div>
                            <span class="text">
                                保存
                            </span>
                        </div>
                    </li>
                </ul>
                <div class="content">
                    <Tabs class="mainTab" name="mainTab" :value="activeTab" :animated="false" type="card"
                        @on-click="ifAdd">
                        <tab-pane label="首页" name="index" index="a" :closable="true" tab="mainTab"
                            style="padding: 0 10px">
                            <h1>
                                Welcome to DataService
                            </h1>
                        </tab-pane>
                        <tab-pane v-for="tab in mainTabs" :key="tab.label" :label="tab.label" :name="tab.name"
                            :index="tab.index" :closable="tab.closable" tab="mainTab" style="padding: 0 10px">
                            <!--服务配置-->
                            <fieldset>
                                <legend>数据库关联</legend>
                            </fieldset>
                            <ul class="line-layout">
                                <li>

                                    <i-Select v-model="datasource.id" placeholder="请选择数据源">
                                        <Option v-for="item in datasource.list" :key="item.id" :value="item.id">{{
                                            item.name }}</Option>
                                    </i-Select>
                                </li>
                                <li>
                                    <i-input ref="inputName">
                                        <span slot="prepend">数据库表名</span>
                                    </i-input>
                                </li>
                            </ul>



                        </tab-pane>
                    </Tabs>
                </div>

                <div class="status-bar">Sss</div>
            </div>
        </Split>
        <Modal title="数据源配置" v-model="isShowDataSource" ok-text="保存" cancel-text="" width="900">
            <DataSource />
        </Modal>
    </div>

    <template id="DataSourceTpl">
        <div class="datasource" style="overflow: hidden">
            <div class="left">
                <ul>
                    <li v-for="datasource in datasources" :key="datasource.id" @click="active(datasource.id)"
                        :class="{ actived: datasource.actived }">
                        <span>
                            <Icon type="md-trash" style="float: right; margin-top: 3px"
                                @click="del(datasource.id, $event)" />
                        </span>
                        {{datasource.name}}
                    </li>
                </ul>
                <a class="add" @click="add">+ 新建……</a>
            </div>
            <div class="right">
                <i-Form ref="editForm" :model="form.data" :rules="form.createRules" :label-width="120"
                    style="margin-right:100px">
                    <form-item label="数据源名称：" prop="urlDir">
                        <i-Input v-model="form.data.urlDir" placeholder="数据源编码全局唯一不重复" />
                    </form-item>
                    <form-item label="数据库类型：" prop="type">
                        <i-Select v-model="form.data.type">
                            <Option v-for="(value, key) in DBType" :value="value" :key="value">{{ key }}</Option>
                        </i-Select>
                    </form-item>
                    <form-item label="连接地址：" prop="url">
                        <i-Input v-model="form.data.url" maxlength="200" show-word-limit type="textarea" :rows="4"
                            placeholder="数据库连接 URL，注意无须携带用户名和密码，且不需要 URL 转义" />
                    </form-item>
                    <form-item label="登录用户：" prop="username">
                        <i-Input v-model="form.data.username" placeholder="请输入数据库用户账号" />
                    </form-item>
                    <form-item label="登录密码：" prop="password">
                        <i-Input v-model="form.data.password" type="password" password placeholder="请输入账号密码" />
                    </form-item>
                    <form-item label="是否跨库：" prop="crossDB">
                        <i-switch v-model="form.data.crossDB" />
                    </form-item>
                </i-Form>
                <!--                 <i-Input v-model="editing.name" ref="inputName">
                    <span slot="prepend">环境名称</span>
                </i-Input>
                <br />
                <i-Input v-model="editing.urlPrefix">
                    <span slot="prepend">URL前缀</span>
                </i-Input> -->
            </div>
        </div>
    </template>

    <script src="datasource.js"> </script>
    <script src="main.js"> </script>
</body>

</html>