/**
 * https://github.com/kele527/iSlider
 * https://github.com/kele527/iSlider/blob/master/demo5.html
 */

/*! H5SPA 1.0.0 | 2016-08-20 22:47:44 */
!function(a,b){var c=0,d=-1,e=1,f=null,g={init:function(){/(windows)/i.test(navigator.userAgent)&&(location.href="views/pc.html"),b.addEventListener("DOMContentLoaded",function(){f=b.querySelectorAll(".pagenumber div"),g.bindTouchEvent(),g.bindBtnClick(),g.setPageNow()}.bind(g),!1)}(),bindBtnClick:function(){var a=b.querySelector("#testbtn");a.addEventListener("touchstart",function(){console.log("touch")})},transform:function(a){this.style.webkitTransform="translate3d("+a+"px,0,0)",c=a},setPageNow:function(){-1!=d&&(f[d].className=""),d=e-1,f[d].className="now"},bindTouchEvent:function(){var d,g,h=b.querySelector("#viewport"),i=a.innerWidth,j=-i*(f.length-1),k=0,l=0,m="left",n=!1,o=0;b.addEventListener("touchstart",function(a){a.preventDefault();var b=a.touches[0];d=b.pageX,g=b.pageY,k=c,h.style.webkitTransition="",o=(new Date).getTime(),n=!1}.bind(this),!1),b.addEventListener("touchmove",function(a){a.preventDefault();var b=a.touches[0],c=b.pageX-d,e=b.pageY-g;if(Math.abs(c)>Math.abs(e)){l=c;var f=k+c;0>=f&&f>=j&&(this.transform.call(h,f),n=!0),m=c>0?"right":"left"}}.bind(this),!1),b.addEventListener("touchend",function(a){a.preventDefault();var b=0,d=(new Date).getTime()-o;n&&(h.style.webkitTransition="0.3s ease -webkit-transform",300>d?(b="left"==m?c-(i+l):c+i-l,b=b>0?0:b,b=j>b?j:b):Math.abs(l)/i<.5?b=c-l:(b="left"==m?c-(i+l):c+i-l,b=b>0?0:b,b=j>b?j:b),this.transform.call(h,b),e=Math.round(Math.abs(b)/i)+1,setTimeout(function(){this.setPageNow()}.bind(this),100))}.bind(this),!1)}}}(window,document);


;function iSlider(opts){this.opts={wrap:".wrap",item:".item",playClass:"play",index:0,noslide:[],noslideBack:false,speed:400,triggerDist:30,isVertical:true,useACC:true,fullScr:true,preventMove:false,lastLocate:true,loadingImgs:[],onslide:function(index){},onloading:function(loaded,total){},loadingOverTime:15};for(var i in opts){this.opts[i]=opts[i]}this.SS=false;try{this.SS=sessionStorage;this.SS["spt"]=1}catch(e){this.SS=0}this.init()}iSlider.prototype={wrap:null,index:0,length:0,_tpl:[],_delayTime:150,_sessionKey:location.host+location.pathname,_prev:null,_current:null,_next:null,$:function(o,p){return(p||document).querySelector(o)},addClass:function(o,cls){if(o.classList){o.classList.add(cls)}else{o.className+=" "+cls}},removeClass:function(o,cls){if(o.classList){o.classList.remove(cls)}else{o.className=o.className.replace(new RegExp("\\s*\\b"+cls+"\\b","g"),"")}},init:function(){var self=this;this.wrap=typeof this.opts.wrap=="string"?this.$(this.opts.wrap):this.opts.wrap;if(this.SS){this._sessionKey=btoa(encodeURIComponent(this._sessionKey+this.wrap.id+this.wrap.className));var lastLocateIndex=parseInt(this.SS[this._sessionKey]);this.index=(this.opts.lastLocate&&lastLocateIndex>=0)?lastLocateIndex:0}else{this.index=this.opts.index||0}if(!this.wrap){throw Error('"wrap" param can not be empty!');return}this._tpl=this.wrap.cloneNode(true);this._tpl=this.opts.item?this._tpl.querySelectorAll(this.opts.item):this._tpl.children;for(var i=0;i<this._tpl.length;i++){this._tpl[i].style.cssText+="display:block;position:absolute;left:0;top:0;width:100%;height:100%"}this.length=this._tpl.length;this.touchInitPos=0;this.startPos=0;this.totalDist=0,this.deltaX1=0;this.deltaX2=0;if(this.opts.fullScr){var s=document.createElement("style");s.innerHTML="html,body{width:100%;height:100%;overflow:hidden}";document.head.appendChild(s);s=null}this.wrap.style.cssText+="display:block;position:relative;"+(this.opts.fullScr?"width:100%;height:100%":"");this.displayWidth=this.wrap.clientWidth;this.displayHeight=this.wrap.clientHeight;this.scrollDist=this.opts.isVertical?this.displayHeight:this.displayWidth;this._setHTML();if(this.opts.loadingImgs&&this.opts.loadingImgs.length){this._loading()}else{this._pageInit()}if(/iPhone|iPod|iPad/.test(navigator.userAgent)){this._delayTime=50}this._bindEvt()},_bindEvt:function(){var self=this;var handlrElm=this.opts.fullScr?this.$("body"):this.wrap;handlrElm.addEventListener("touchstart",function(e){self._touchstart(e)},false);handlrElm.addEventListener("touchmove",function(e){self._touchmove(e);if(!self.opts.fullScr){e.stopPropagation();e.preventDefault()}},false);handlrElm.addEventListener("touchend",function(e){self._touchend(e)},false);handlrElm.addEventListener("touchcancel",function(e){self._touchend(e)},false);if(this.opts.fullScr||this.opts.preventMove){handlrElm.addEventListener("touchmove",function(e){e.target.getAttribute("data-stop")!=="true"&&e.preventDefault()},false)}},_setHTML:function(index){if(index>=0){this.index=parseInt(index)}this.wrap.innerHTML="";var initDom=document.createDocumentFragment();if(this.index>0){this._prev=this._tpl[this.index-1].cloneNode(true);this._prev.style.cssText+=this._getTransform("-"+this.scrollDist+"px");initDom.appendChild(this._prev)}else{this._prev=null}this._current=this._tpl[this.index].cloneNode(true);this._current.style.cssText+=this._getTransform(0);initDom.appendChild(this._current);if(this.index<this.length-1){this._next=this._tpl[this.index+1].cloneNode(true);this._next.style.cssText+=this._getTransform(this.scrollDist+"px");initDom.appendChild(this._next)}else{this._next=null}this.wrap.appendChild(initDom)},_pageInit:function(){var self=this;setTimeout(function(){self.addClass(self._current,self.opts.playClass);try{self.opts.onslide.call(self,self.index)}catch(e){}},this._delayTime)},_touchstart:function(e){var self=this;if(e.target.getAttribute("data-stop")==="true"){return}if(e.touches.length!==1){return}this.lockSlide=false;this._touchstartX=e.touches[0].pageX;this._touchstartY=e.touches[0].pageY;this.touchInitPos=this.opts.isVertical?e.touches[0].pageY:e.touches[0].pageX;this.deltaX1=this.touchInitPos;this.startPos=0;this.startPosPrev=-this.scrollDist;this.startPosNext=this.scrollDist;if(this._next){self._next.style.cssText+="-webkit-transition-duration:0;"}self._current.style.cssText+="-webkit-transition-duration:0;";if(this._prev){self._prev.style.cssText+="-webkit-transition-duration:0;"}},_touchmove:function(e){var parent=e.target;if(parent.getAttribute("stop")==="true"){return}do{parent=parent.parentNode}while(parent&&parent!=this.wrap);if(!parent&&e.target!=this.wrap){return}var self=this;if(e.touches.length!==1||this.lockSlide){return}var gx=Math.abs(e.touches[0].pageX-this._touchstartX);var gy=Math.abs(e.touches[0].pageY-this._touchstartY);if(gx>gy&&this.opts.isVertical){this.lockSlide=true;return}else{if(gx<gy&&!this.opts.isVertical){this.lockSlide=true;return}}if(this.opts.noslide&&this.opts.noslide.indexOf(this.index)>=0){if(!this.opts.noslideBack||(this.opts.isVertical?(e.touches[0].pageY-this._touchstartY<0):(e.touches[0].pageX-this._touchstartX<0))){return
}}var currentX=this.opts.isVertical?e.touches[0].pageY:e.touches[0].pageX;this.deltaX2=currentX-this.deltaX1;this.totalDist=this.startPos+currentX-this.touchInitPos;self._current.style.cssText+=this._getTransform(this.totalDist+"px");this.startPos=this.totalDist;if(this.totalDist<0){if(this._next){this.totalDist2=this.startPosNext+currentX-this.touchInitPos;self._next.style.cssText+=this._getTransform(this.totalDist2+"px");this.startPosNext=this.totalDist2}}else{if(this._prev){this.totalDist2=this.startPosPrev+currentX-this.touchInitPos;self._prev.style.cssText+=this._getTransform(this.totalDist2+"px");this.startPosPrev=this.totalDist2}}this.touchInitPos=currentX},_touchend:function(e){if(e.target.getAttribute("stop")==="true"){return}if(this.deltaX2<-this.opts.triggerDist){this.next()}else{if(this.deltaX2>this.opts.triggerDist){this.prev()}else{this._itemReset()}}this.deltaX2=0},_getTransform:function(dist){var pos=this.opts.isVertical?"0,"+dist:dist+",0";return";-webkit-transform:"+(this.opts.useACC?"translate3d("+pos+",0)":"translate("+pos+")")},_itemReset:function(){var self=this;self._current.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform(0);if(self._prev){self._prev.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform("-"+this.scrollDist+"px")}if(self._next){self._next.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform(this.scrollDist+"px")}this.deltaX2=0},_loading:function(){var self=this;var imgurls=this.opts.loadingImgs;var fallback=setTimeout(function(){try{self.opts.onloading.call(self,total,total)}catch(e){}self._pageInit()},this.opts.loadingOverTime*1000);var imgs=[],loaded=1;var total=imgurls.length+1;for(var i=0;i<imgurls.length;i++){imgs[i]=new Image();imgs[i].src=imgurls[i];imgs[i].onload=imgs[i].onerror=imgs[i].onabort=function(e){loaded++;if(this.src===imgurls[0]&&e.type==="load"){clearTimeout(fallback)}checkloaded();this.onload=this.onerror=this.onabort=null}}try{self.opts.onloading.call(self,1,total)}catch(e){}function checkloaded(){try{self.opts.onloading.call(self,loaded,total)}catch(e){}if(loaded==total){if(fallback){clearTimeout(fallback)}self._pageInit();imgs=null;if(self.opts.preLoadingImgs&&self.opts.preLoadingImgs.length){self.preloading()}}}},prev:function(){var self=this;if(!this._current||!this._prev){this._itemReset();return}if(this.index>0){this.index--}else{this._itemReset();return false}if(this._next){this.wrap.removeChild(this._next)}this._next=this._current;this._current=this._prev;this._prev=null;this._next.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform(this.scrollDist+"px");this._current.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform(0);if(this.SS){this.SS[this._sessionKey]=this.index}setTimeout(function(){if(self.$("."+self.opts.playClass,self.wrap)){self.removeClass(self.$("."+self.opts.playClass,self.wrap),self.opts.playClass)}self.addClass(self._current,self.opts.playClass);try{self.opts.onslide.call(self,self.index)}catch(e){}var prevIndex=self.index-1;if(prevIndex<0){prevIndex=self.length-1;return false}self._prev=self._tpl[prevIndex].cloneNode(true);self._prev.style.cssText+="-webkit-transition-duration:0ms;"+self._getTransform("-"+self.scrollDist+"px");self.wrap.insertBefore(self._prev,self._current)},this._delayTime)},next:function(){var self=this;if(!this._current||!this._next){this._itemReset();return}if(this.index<this.length-1){this.index++}else{this._itemReset();return false}if(this._prev){this.wrap.removeChild(this._prev)}this._prev=this._current;this._current=this._next;this._next=null;this._prev.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform("-"+this.scrollDist+"px");this._current.style.cssText+="-webkit-transition-duration:"+this.opts.speed+"ms;"+this._getTransform(0);if(this.SS){this.SS[this._sessionKey]=this.index}setTimeout(function(){if(self.$("."+self.opts.playClass,self.wrap)){self.removeClass(self.$("."+self.opts.playClass,self.wrap),self.opts.playClass)}self.addClass(self._current,self.opts.playClass);try{self.opts.onslide.call(self,self.index)}catch(e){}var nextIndex=self.index+1;if(nextIndex>=self.length){return false}self._next=self._tpl[nextIndex].cloneNode(true);self._next.style.cssText+="-webkit-transition-duration:0ms;"+self._getTransform(self.scrollDist+"px");self.wrap.appendChild(self._next)},this._delayTime)},slideTo:function(index){this._setHTML(index);this._pageInit()}};if(typeof module=="object"){module.exports=iSlider}else{window.iSlider=iSlider};